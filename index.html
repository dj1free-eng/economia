<!-- index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Econom√≠a Familiar ¬∑ v2.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="css/style.css">
  <!-- Chart.js para informes -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="toast" id="toast"></div>

  <!-- Modal edici√≥n gen√©rica -->
  <div class="modal-overlay" id="editModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="editModalTitle">Editar</div>
        <button class="modal-close" id="editModalClose">‚úï</button>
      </div>
      <div id="editModalBody">
        <div class="form-grid">
          <div class="form-group">
            <label for="editNombre">Nombre / concepto</label>
            <input type="text" id="editNombre" />
          </div>
          <div class="form-group">
            <label for="editImporte">Importe (‚Ç¨)</label>
            <input type="number" step="0.01" id="editImporte" />
          </div>
          <div class="form-group">
            <label for="editExtra">Dato extra (categor√≠a / nota)</label>
            <input type="text" id="editExtra" />
          </div>
          <div class="form-group" id="editFechaGroup">
            <label for="editFecha" id="editFechaLabel">Fecha</label>
            <input type="date" id="editFecha" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="editModalCancel">Cancelar</button>
        <button class="btn btn-primary" id="editModalSave">Guardar cambios</button>
      </div>
    </div>
  </div>

  <!-- Modal confirmaci√≥n borrado -->
  <div class="modal-overlay" id="confirmModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Confirmar eliminaci√≥n</div>
        <button class="modal-close" id="confirmClose">‚úï</button>
      </div>
      <div id="confirmMessage">¬øSeguro que quieres eliminar este elemento?</div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="confirmCancel">Cancelar</button>
        <button class="btn btn-danger" id="confirmOk">Eliminar</button>
      </div>
    </div>
  </div>

  <!-- Modal informe gastos fijos -->
  <div class="modal-overlay" id="reportModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Informe gastos fijos</div>
        <button class="modal-close" id="reportClose">‚úï</button>
      </div>
      <div class="report-content">
        <canvas id="fixedReportChart" height="220"></canvas>
        <div class="report-totals">
          <div class="chip-row" id="fixedReportTotals"></div>
          <div id="fixedReportList"></div>
          <div class="report-grand-total">
            Total general: <span id="fixedReportGrandTotal">0 ‚Ç¨</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="reportOk">Cerrar</button>
      </div>
    </div>
  </div>

  <header>
    <div class="header-inner">
      <div class="title-row">
        <div class="title-main">
          <div class="title-icon">üí∞</div>
          <div class="title-text">
            <strong>Econom√≠a Familiar ¬∑ v2.0</strong>
            <span>Control total de gastos e ingresos</span>
          </div>
        </div>
        <div class="month-nav-container">
          <button class="month-nav-btn" id="btnPrevMonth">‚óÄ</button>
          <div class="month-display" id="monthDisplay">Enero 2024</div>
          <button class="month-nav-btn" id="btnNextMonth">‚ñ∂</button>
          <div class="month-picker-dropdown" id="monthPickerDropdown">
            <div class="month-picker-header">
              <button class="year-nav-btn" id="yearPrev">‚óÄ</button>
              <div class="month-picker-year" id="pickerYear">2024</div>
              <button class="year-nav-btn" id="yearNext">‚ñ∂</button>
            </div>
            <div class="months-grid" id="monthsGrid"></div>
          </div>
        </div>
      </div>

      <div class="summary-row">
        <div class="summary-card">
          <div class="summary-label">Ingresos</div>
          <div class="summary-value" id="sumIngresos">0 ‚Ç¨</div>
        </div>
        <div class="summary-card">
          <div class="summary-label">Gastos fijos</div>
          <div class="summary-value" id="sumFijos">0 ‚Ç¨</div>
        </div>
        <div class="summary-card">
          <div class="summary-label">Gastos variables</div>
          <div class="summary-value" id="sumVariables">0 ‚Ç¨</div>
        </div>
        <div class="summary-card summary-card-balance">
          <div class="summary-label">Balance</div>
          <div class="summary-value" id="sumBalance">0 ‚Ç¨</div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="app">
      <div class="tabs-container">
        <div class="tabs-wrapper">

          <!-- TAB RESUMEN -->
          <section class="tab-section active" data-tab="resumen" id="tab-resumen">
            <h2>Resumen del mes</h2>
            <p class="section-hint">
              Vista r√°pida de ingresos, gastos, sobres y huchas para el mes seleccionado.
            </p>

            <div class="resumen-grid">
              <div class="card">
                <h3>Ingresos base</h3>
                <form id="formIngresosBase" class="form-grid">
                  <div class="form-group">
                    <label for="ingJuan">Juan</label>
                    <input type="number" step="0.01" id="ingJuan" />
                  </div>
                  <div class="form-group">
                    <label for="ingSaray">Saray</label>
                    <input type="number" step="0.01" id="ingSaray" />
                  </div>
                  <div class="form-group">
                    <label for="ingOtros">Otros</label>
                    <input type="number" step="0.01" id="ingOtros" />
                  </div>
                  <button class="btn btn-primary full-width" type="submit">
                    Guardar ingresos base
                  </button>
                </form>
              </div>

              <div class="card">
                <h3>Ingresos puntuales</h3>
                <form id="formIngresoPuntual" class="form-grid">
                  <div class="form-group">
                    <label for="ingPuntualFecha">Fecha</label>
                    <input type="date" id="ingPuntualFecha" />
                  </div>
                  <div class="form-group">
                    <label for="ingPuntualDesc">Concepto</label>
                    <input type="text" id="ingPuntualDesc" />
                  </div>
                  <div class="form-group">
                    <label for="ingPuntualImporte">Importe (‚Ç¨)</label>
                    <input type="number" step="0.01" id="ingPuntualImporte" />
                  </div>
                  <button class="btn btn-primary full-width" type="submit">
                    A√±adir ingreso
                  </button>
                </form>

                <div class="pill-list" id="listaIngresosPuntuales"></div>
              </div>
            </div>
          </section>

          <!-- TAB GASTOS FIJOS -->
          <section class="tab-section" data-tab="fijos" id="tab-fijos">
            <h2>Gastos fijos</h2>
            <p class="section-hint">
              A√±ade tus gastos fijos y as√≠gnales una categor√≠a. Los que tengan mes de fin dejar√°n de contarse a partir de ese mes.
            </p>

            <form id="formGastoFijo" class="form-grid">
              <div class="form-group">
                <label for="fijoNombre">Concepto</label>
                <input type="text" id="fijoNombre" required />
              </div>
              <div class="form-group">
                <label for="fijoImporte">Importe mensual (‚Ç¨)</label>
                <input type="number" step="0.01" id="fijoImporte" required />
              </div>
              <div class="form-group">
                <label>Categoria</label>
                <div class="chip-row" id="fijoCategoriaChips">
                  <button type="button" class="chip chip-select chip-active" data-cat="Suministros">Suministros</button>
                  <button type="button" class="chip chip-select" data-cat="Pr√©stamos">Pr√©stamos</button>
                  <button type="button" class="chip chip-select" data-cat="Suscripciones">Suscripciones</button>
                  <button type="button" class="chip chip-select" data-cat="Varios">Varios</button>
                </div>
              </div>
              <div class="form-group">
                <label for="fijoEndMonth">Mes l√≠mite (opcional, formato YYYY-MM)</label>
                <input type="month" id="fijoEndMonth" />
              </div>
              <button class="btn btn-primary full-width" type="submit">
                A√±adir gasto fijo
              </button>
            </form>

            <div class="chips-filtro">
              <span>Filtrar por categor√≠a:</span>
              <div class="chip-row" id="fijoFiltroChips">
                <button type="button" class="chip chip-filter chip-active" data-filter="Todos">Todos</button>
                <button type="button" class="chip chip-filter" data-filter="Suministros">Suministros</button>
                <button type="button" class="chip chip-filter" data-filter="Pr√©stamos">Pr√©stamos</button>
                <button type="button" class="chip chip-filter" data-filter="Suscripciones">Suscripciones</button>
                <button type="button" class="chip chip-filter" data-filter="Varios">Varios</button>
              </div>
            </div>

            <div class="table-wrapper">
              <table class="fixed-expense-table">
                <thead>
                  <tr>
                    <th>Concepto</th>
                    <th>Categor√≠a</th>
                    <th>Importe</th>
                    <th>Fin</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="tablaFijosBody"></tbody>
              </table>
            </div>

            <button class="btn btn-outline full-width" id="btnVerInformeFijos">
              Ver informe por categor√≠as
            </button>
          </section>

          <!-- TAB GASTOS VARIABLES -->
          <section class="tab-section" data-tab="variables" id="tab-variables">
            <h2>Gastos variables</h2>
            <p class="section-hint">
              Registra tus gastos diarios. Se usan para el resumen mensual y para los sobres.
            </p>

            <form id="formGastoVariable" class="form-grid">
              <div class="form-group">
                <label for="varFecha">Fecha</label>
                <input type="date" id="varFecha" />
              </div>
              <div class="form-group">
                <label for="varCategoria">Categor√≠a</label>
                <input type="text" id="varCategoria" placeholder="Supermercado, gasolina..." />
              </div>
              <div class="form-group">
                <label for="varDesc">Descripci√≥n</label>
                <input type="text" id="varDesc" />
              </div>
              <div class="form-group">
                <label for="varImporte">Importe (‚Ç¨)</label>
                <input type="number" step="0.01" id="varImporte" />
              </div>
              <button class="btn btn-primary full-width" type="submit">
                A√±adir gasto
              </button>
            </form>

            <div class="expense-list" id="listaGastosVariables"></div>
          </section>

          <!-- TAB SOBRES / PRESUPUESTOS -->
          <section class="tab-section" data-tab="sobres" id="tab-sobres">
            <h2>Sobres / Presupuestos</h2>
            <p class="section-hint">
              Crea sobres por categor√≠a. Las barras muestran cu√°nto has gastado este mes frente al presupuesto.
            </p>

            <form id="formSobre" class="form-grid">
              <div class="form-group">
                <label for="sobreNombre">Categor√≠a / sobre</label>
                <input type="text" id="sobreNombre" />
              </div>
              <div class="form-group">
                <label for="sobreImporte">Presupuesto mensual (‚Ç¨)</label>
                <input type="number" step="0.01" id="sobreImporte" />
              </div>
              <button class="btn btn-primary full-width" type="submit">
                A√±adir sobre
              </button>
            </form>

            <div id="listaSobres"></div>
          </section>

          <!-- TAB HUCHAS -->
          <section class="tab-section" data-tab="huchas" id="tab-huchas">
            <h2>Huchas</h2>
            <p class="section-hint">
              Objetivos de ahorro. Usa los botones para aportar o retirar dinero.
            </p>

            <form id="formHucha" class="form-grid">
              <div class="form-group">
                <label for="huchaNombre">Nombre de la hucha</label>
                <input type="text" id="huchaNombre" />
              </div>
              <div class="form-group">
                <label for="huchaObjetivo">Objetivo (‚Ç¨)</label>
                <input type="number" step="0.01" id="huchaObjetivo" />
              </div>
              <button class="btn btn-primary full-width" type="submit">
                Crear hucha
              </button>
            </form>

            <div id="listaHuchas"></div>
          </section>

          <!-- TAB NOTAS / DATOS -->
          <section class="tab-section" data-tab="notas" id="tab-notas">
            <h2>Notas del mes</h2>
            <p class="section-hint">
              Escribe cualquier detalle importante de este mes.
            </p>
            <textarea id="notasMes" class="notes-box" placeholder="Notas para este mes..."></textarea>

            <h3>Exportar / Importar datos</h3>
            <div class="card">
              <div class="form-grid">
                <button class="btn btn-primary" id="btnExportJSON">Exportar JSON</button>
                <label class="btn btn-outline file-label">
                  Importar JSON
                  <input type="file" id="inputImportJSON" accept="application/json" hidden />
                </label>
              </div>

              <h4>Importar CSV CaixaBank</h4>
              <p class="section-hint small">
                Formato: Concepto;Fecha;Importe;Saldo. Los importes positivos se a√±aden como ingresos, los negativos como gastos.
              </p>
              <label class="btn btn-outline file-label">
                Importar CSV
                <input type="file" id="inputImportCSV" accept=".csv,text/csv" hidden />
              </label>
            </div>
          </section>

        </div>
      </div>
    </div>
  </main>

  <nav class="bottom-nav">
    <div class="bottom-nav-inner">
      <button class="tab-btn active" data-tab-target="resumen">
        <div class="tab-btn-icon">üè†</div>
        <span class="label">Resumen</span>
      </button>
      <button class="tab-btn" data-tab-target="fijos">
        <div class="tab-btn-icon">üìå</div>
        <span class="label">Fijos</span>
      </button>
      <button class="tab-btn" data-tab-target="variables">
        <div class="tab-btn-icon">üí≥</div>
        <span class="label">Variables</span>
      </button>
      <button class="tab-btn" data-tab-target="sobres">
        <div class="tab-btn-icon">üì¶</div>
        <span class="label">Sobres</span>
      </button>
      <button class="tab-btn" data-tab-target="huchas">
        <div class="tab-btn-icon">üê∑</div>
        <span class="label">Huchas</span>
      </button>
      <button class="tab-btn" data-tab-target="notas">
        <div class="tab-btn-icon">‚öôÔ∏è</div>
        <span class="label">Notas</span>
      </button>
    </div>
  </nav>

  <script src="js/app.js"></script>
  <script src="js/swipe.js"></script>
</body>
</html>
